\documentclass[a4paper]{article}
% generated by Docutils <https://docutils.sourceforge.io/>
\usepackage{cmap} % fix search and cut-and-paste in Acrobat
\usepackage{ifthen}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{color}
\setcounter{secnumdepth}{0}

\usepackage{fontspec}
\setmainfont{Junicode.ttf}[
	BoldFont = Junicode-Bold.ttf ,
	BoldItalicFont = Junicode-BoldItalic.ttf ,
	ItalicFont = Junicode-Italic.ttf
]
\setmonofont{iosevka-extended.ttf}[
	BoldFont = iosevka-extendedbold.ttf ,
	BoldItalicFont = iosevka-extendedbolditalic.ttf ,
	ItalicFont = iosevka-extendeditalic.ttf
]

%%% Custom LaTeX preamble
% PDF Standard Fonts

%%% User specified packages and stylesheets
\usepackage{alectryon}
\usepackage{pygments}

%%% Fallback definitions for Docutils-specific commands

% basic code highlight:
\providecommand*\DUrolecomment[1]{\textcolor[rgb]{0.40,0.40,0.40}{#1}}
\providecommand*\DUroledeleted[1]{\textcolor[rgb]{0.40,0.40,0.40}{#1}}
\providecommand*\DUrolekeyword[1]{\textbf{#1}}
\providecommand*\DUrolestring[1]{\textit{#1}}

% custom inline roles: \DUrole{#1}{#2} tries \DUrole#1{#2}
\providecommand*{\DUrole}[2]{%
  \ifcsname DUrole#1\endcsname%
    \csname DUrole#1\endcsname{#2}%
  \else%
    #2%
  \fi%
}

% hyperlinks:
\ifthenelse{\isundefined{\hypersetup}}{
  \usepackage[colorlinks=true,linkcolor=blue,urlcolor=blue]{hyperref}
  \usepackage{bookmark}
  \urlstyle{same} % normal text font (alternatives: tt, rm, sf)
}{}
\hypersetup{
  pdftitle={DFAs in Coq},
}

%%% Body
\begin{document}
\title{DFAs in Coq%
  \label{dfas-in-coq}}
\author{}
\date{}
\maketitle

\phantomsection\label{table-of-contents}
\pdfbookmark[1]{Table of Contents}{table-of-contents}
\renewcommand{\contentsname}{Table of Contents}
\tableofcontents

DFAs are defined as a 5-tuples; A DFA $M$ is defined as 
$(Q, \Sigma, s, F, \delta)$, where:

\begin{description}
\item[{$Q$}] 
is the finite set of states.

\item[{$\Sigma$}] 
is the finite set of input symbols, also called the alphabet.

\item[{$\delta : Q \times \Sigma \to Q$}] 
is the transition function.

\item[{$s \in Q$}] 
is the initial or start state.

\item[{$F \subseteq Q$}] 
is the set of final or accept states.

\end{description}

The Coq formalization is as follows:

\begin{alectryon}
  % Generator: Alectryon
  \sep
  \begin{sentence}
    \begin{input}
      \PY{k+kn}{Record}~\PY{n+nf}{dfa}~\PY{o}{(}\PY{n+nv}{Q}~\PY{n+nv}{Σ}~\PY{o}{:}~\PY{k+kt}{Type}\PY{o}{)}~\PY{o}{:=}~\PY{o}{\PYZob{}}\nl
      ~~\PY{n}{states}~\PY{o}{:}~\PY{n}{list}~\PY{n}{Q}\PY{o}{;}\nl
      ~~\PY{n}{char}~\PY{o}{:}~\PY{n}{list}~\PY{n}{Σ}\PY{o}{;}\nl
      ~~\PY{n}{s}~\PY{o}{:}~\PY{n}{Q}\PY{o}{;}\nl
      ~~\PY{n}{F}~\PY{o}{:}~\PY{n}{Q}~\PY{o}{\PYZhy{}\PYZgt{}}~\PY{n}{bool}\PY{o}{;}\nl
      ~~\PY{n}{δ}~\PY{o}{:}~\PY{n}{Q}~\PY{o}{\PYZhy{}\PYZgt{}}~\PY{n}{Σ}~\PY{o}{\PYZhy{}\PYZgt{}}~\PY{n}{Q}\PY{o}{;}\nl
      \PY{o}{\PYZcb{}.}
    \end{input}
  \end{sentence}
\end{alectryon}

\texttt{\DUrole{code}{\DUrole{highlight}{\DUrole{coq}{\DUrole{kt}{Type}}}}} is effectively infinite, so finiteness is ensured by also asking 
for a list of the states and characters of the alphabet. As a notion of finite 
sets has not been developed in this project, the notion of being a final state 
is defined as a boolean predicate; if \texttt{\DUrole{code}{\DUrole{highlight}{\DUrole{coq}{\DUrole{n}{M}\DUrole{o}{.(}\DUrole{n}{F}\DUrole{o}{)} \DUrole{n}{q}}}}} is \texttt{\DUrole{code}{\DUrole{highlight}{\DUrole{coq}{\DUrole{n}{true}}}}} then 
it is a final state, else it is not.


\section{Computation%
  \label{computation}%
}

Computation is defined here using the $\delta^*$ function which is
defined in Coq as \texttt{\DUrole{code}{\DUrole{highlight}{\DUrole{coq}{\DUrole{n}{delta\_star}}}}}:

\begin{alectryon}
  % Generator: Alectryon
  \sep
  \begin{sentence}
    \begin{input}
      \PY{k+kn}{Fixpoint}~\PY{n+nf}{delta\PYZus{}star}~\PY{o}{\PYZob{}}\PY{n+nv}{Q}~\PY{n+nv}{Σ}~\PY{o}{:}~\PY{k+kt}{Type}\PY{o}{\PYZcb{}}~\PY{o}{(}\PY{n+nv}{M}~\PY{o}{:}~\PY{n}{dfa}~\PY{n}{Q}~\PY{n}{Σ}\PY{o}{)}~\PY{o}{(}\PY{n+nv}{p}~\PY{o}{:}~\PY{n}{Q}\PY{o}{)}~\PY{o}{(}\PY{n+nv}{x}~\PY{o}{:}~\PY{n}{list}~\PY{n}{Σ}\PY{o}{)}~\PY{o}{:=}\nl
      ~~\PY{k+kr}{match}~\PY{n}{x}~\PY{k+kr}{with}\nl
      ~~\PY{o}{|}~\PY{o}{[]}~\PY{o}{=\PYZgt{}}~\PY{n}{p}\nl
      ~~\PY{o}{|}~\PY{n}{x}~\PY{o}{::}~\PY{n}{xs}~\PY{o}{=\PYZgt{}}~\PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{o}{(}\PY{n}{M}\PY{o}{.(}\PY{n}{δ}\PY{o}{)}~\PY{n}{p}~\PY{n}{x}\PY{o}{)}~\PY{n}{xs}\nl
      \PY{k+kr}{end}\PY{o}{.}
    \end{input}
  \end{sentence}
\end{alectryon}

Some properties about $\delta^*$ are now proved.

\begin{alectryon}
  % Generator: Alectryon
  \sep
  \begin{sentence}
    \begin{input}
      \PY{k+kn}{Section}~\PY{n+nf}{DeltaStar}\PY{o}{.}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{txt}
    \nl
  \end{txt}
  \sep
  \begin{sentence}
    \begin{input}
      ~~\PY{k+kn}{Variables}~\PY{n+nv}{Q}~\PY{n+nv}{Σ}~\PY{o}{:}~\PY{k+kt}{Type}\PY{o}{.}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~\PY{k+kn}{Variable}~\PY{n+nv}{M}~\PY{o}{:}~\PY{n}{dfa}~\PY{n}{Q}~\PY{n}{Σ}\PY{o}{.}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{txt}
    \nl
  \end{txt}
  \sep
  \begin{sentence}
    \begin{input}
      ~~\PY{k+kn}{Lemma}~\PY{n+nf}{delta\PYZus{}cons}~\PY{o}{:}~\PY{k+kr}{forall}~\PY{n+nv}{p}~\PY{n+nv}{a}~\PY{n+nv}{x}\PY{o}{,}~\nl
      ~~~~\PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{o}{(}\PY{n}{δ}~\PY{n}{M}~\PY{n}{p}~\PY{n}{a}\PY{o}{)}~\PY{n}{x}~\PY{o}{=}~\PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{n}{p}~\PY{o}{(}\PY{n}{a}~\PY{o}{::}~\PY{n}{x}\PY{o}{).}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~\PY{k+kn}{Proof}\PY{o}{.}~
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      \PY{n+nb}{trivial}\PY{o}{.}~
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      \PY{k+kn}{Qed}\PY{o}{.}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{txt}
    \nl
  \end{txt}
  \sep
  \begin{sentence}
    \begin{input}
      ~~\PY{k+kn}{Lemma}~\PY{n+nf}{delta\PYZus{}cat}~\PY{o}{:}~\PY{k+kr}{forall}~\PY{n+nv}{p}~\PY{n+nv}{x}~\PY{n+nv}{y}\PY{o}{,}\nl
      ~~~~\PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{n}{p}~\PY{o}{(}\PY{n}{x}~\PY{o}{++}~\PY{n}{y}\PY{o}{)}~\PY{o}{=}~\PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{n}{p}~\PY{n}{x}\PY{o}{)}~\PY{n}{y}\PY{o}{.}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~\PY{k+kn}{Proof}\PY{o}{.}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~~~\PY{n+nb}{intros}~\PY{n}{p}~\PY{n}{x}\PY{o}{.}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~~~\PY{n}{gendep}~\PY{n}{p}\PY{o}{.}
    \end{input}
    \sep
    \begin{output}
      \begin{goals}
        \begin{goal}
          \begin{hyps}
            \hyp{Q, Σ}{\PY{k+kt}{Type}}
            \sep
            \hyp{M}{\PY{n}{dfa}~\PY{n}{Q}~\PY{n}{Σ}}
            \sep
            \hyp{x}{\PY{n}{list}~\PY{n}{Σ}}
          \end{hyps}
          \sep
          \infrule{}
          \sep
          \begin{conclusion}
            \PY{k+kr}{forall}~\PY{o}{(}\PY{n+nv}{p}~\PY{o}{:}~\PY{n}{Q}\PY{o}{)}~\PY{o}{(}\PY{n+nv}{y}~\PY{o}{:}~\PY{n}{list}~\PY{n}{Σ}\PY{o}{),}\nl
            \PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{n}{p}~\PY{o}{(}\PY{n}{x}~\PY{o}{++}~\PY{n}{y}\PY{o}{)}~\PY{o}{=}\nl
            \PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{n}{p}~\PY{n}{x}\PY{o}{)}~\PY{n}{y}
          \end{conclusion}
        \end{goal}
      \end{goals}
    \end{output}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~~~\PY{n+nb}{induct}~\PY{n}{x}\PY{o}{.}
    \end{input}
    \sep
    \begin{output}
      \begin{goals}
        \begin{goal}
          \begin{hyps}
            \hyp{Q, Σ}{\PY{k+kt}{Type}}
            \sep
            \hyp{M}{\PY{n}{dfa}~\PY{n}{Q}~\PY{n}{Σ}}
            \sep
            \hyp{a}{\PY{n}{Σ}}
            \sep
            \hyp{x}{\PY{n}{list}~\PY{n}{Σ}}
            \sep
            \hyp{IHx}{\PY{k+kr}{forall}~\PY{o}{(}\PY{n+nv}{p}~\PY{o}{:}~\PY{n}{Q}\PY{o}{)}~\PY{o}{(}\PY{n+nv}{y}~\PY{o}{:}~\PY{n}{list}~\PY{n}{Σ}\PY{o}{),}\nl
            \PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{n}{p}~\PY{o}{(}\PY{n}{x}~\PY{o}{++}~\PY{n}{y}\PY{o}{)}~\PY{o}{=}~\PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{n}{p}~\PY{n}{x}\PY{o}{)}~\PY{n}{y}}
            \sep
            \hyp{p}{\PY{n}{Q}}
            \sep
            \hyp{y}{\PY{n}{list}~\PY{n}{Σ}}
          \end{hyps}
          \sep
          \infrule{}
          \sep
          \begin{conclusion}
            \PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{o}{(}\PY{n}{δ}~\PY{n}{M}~\PY{n}{p}~\PY{n}{a}\PY{o}{)}~\PY{o}{(}\PY{n}{x}~\PY{o}{++}~\PY{n}{y}\PY{o}{)}~\PY{o}{=}\nl
            \PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{o}{(}\PY{n}{δ}~\PY{n}{M}~\PY{n}{p}~\PY{n}{a}\PY{o}{)}~\PY{n}{x}\PY{o}{)}~\PY{n}{y}
          \end{conclusion}
        \end{goal}
      \end{goals}
    \end{output}
  \end{sentence}
\end{alectryon}

The \texttt{\DUrole{code}{\DUrole{highlight}{\DUrole{coq}{\DUrole{n}{induct}}}}} tactic is a custom tactic which tries to discharge the base 
case, because most base cases in induction proofs are easily solvablw with 
basic tactics. As you can see here, \texttt{\DUrole{code}{\DUrole{highlight}{\DUrole{coq}{\DUrole{n}{induct} \DUrole{n}{x}}}}} skips the base case, and
moves on to the inductive case.

\begin{alectryon}
  % Generator: Alectryon
  \sep
  \begin{sentence}
    \begin{input}
      ~~~~\PY{o}{\PYZhy{}}~
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      \PY{n+nb}{rewrite}~\PY{n}{IHx}\PY{o}{.}
    \end{input}
    \sep
    \begin{output}
      \begin{goals}
        \begin{goal}
          \begin{hyps}
            \hyp{Q, Σ}{\PY{k+kt}{Type}}
            \sep
            \hyp{M}{\PY{n}{dfa}~\PY{n}{Q}~\PY{n}{Σ}}
            \sep
            \hyp{a}{\PY{n}{Σ}}
            \sep
            \hyp{x}{\PY{n}{list}~\PY{n}{Σ}}
            \sep
            \hyp{IHx}{\PY{k+kr}{forall}~\PY{o}{(}\PY{n+nv}{p}~\PY{o}{:}~\PY{n}{Q}\PY{o}{)}~\PY{o}{(}\PY{n+nv}{y}~\PY{o}{:}~\PY{n}{list}~\PY{n}{Σ}\PY{o}{),}\nl
            \PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{n}{p}~\PY{o}{(}\PY{n}{x}~\PY{o}{++}~\PY{n}{y}\PY{o}{)}~\PY{o}{=}~\PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{n}{p}~\PY{n}{x}\PY{o}{)}~\PY{n}{y}}
            \sep
            \hyp{p}{\PY{n}{Q}}
            \sep
            \hyp{y}{\PY{n}{list}~\PY{n}{Σ}}
          \end{hyps}
          \sep
          \infrule{}
          \sep
          \begin{conclusion}
            \PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{o}{(}\PY{n}{δ}~\PY{n}{M}~\PY{n}{p}~\PY{n}{a}\PY{o}{)}~\PY{n}{x}\PY{o}{)}~\PY{n}{y}~\PY{o}{=}\nl
            \PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{o}{(}\PY{n}{δ}~\PY{n}{M}~\PY{n}{p}~\PY{n}{a}\PY{o}{)}~\PY{n}{x}\PY{o}{)}~\PY{n}{y}
          \end{conclusion}
        \end{goal}
      \end{goals}
    \end{output}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      \PY{n+nb+bp}{reflexivity}\PY{o}{.}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~\PY{k+kn}{Qed}\PY{o}{.}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{txt}
    \nl
  \end{txt}
  \sep
  \begin{sentence}
    \begin{input}
      ~~\PY{k+kn}{Lemma}~\PY{n+nf}{delta\PYZus{}single}\PY{o}{:}~\PY{k+kr}{forall}~\PY{n+nv}{p}~\PY{n+nv}{a}\PY{o}{,}\nl
      ~~~~~~\PY{n}{M}\PY{o}{.(}\PY{n}{δ}\PY{o}{)}~\PY{n}{p}~\PY{n}{a}~\PY{o}{=}~\PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{n}{p}~\PY{o}{[}\PY{n}{a}\PY{o}{].}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~\PY{k+kn}{Proof}\PY{o}{.}~
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      \PY{n+nb}{trivial}\PY{o}{.}~
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      \PY{k+kn}{Qed}\PY{o}{.}
    \end{input}
  \end{sentence}
\end{alectryon}

The following theorem, \texttt{\DUrole{code}{\DUrole{highlight}{\DUrole{coq}{\DUrole{n}{delta\_step}}}}} is important for future proofs. It is 
also another way to look at the $\delta^*$ function.

\begin{alectryon}
  % Generator: Alectryon
  \sep
  \begin{sentence}
    \begin{input}
      ~~\PY{k+kn}{Theorem}~\PY{n+nf}{delta\PYZus{}step}\PY{o}{:}~\PY{k+kr}{forall}~\PY{n+nv}{w}~\PY{n+nv}{p}~\PY{n+nv}{x}\PY{o}{,}\nl
      ~~~~\PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{n}{p}~\PY{o}{(}\PY{n}{w}~\PY{o}{++}~\PY{o}{[}\PY{n}{x}\PY{o}{])}~\PY{o}{=}~\PY{n}{M}\PY{o}{.(}\PY{n}{δ}\PY{o}{)}~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{n}{p}~\PY{n}{w}\PY{o}{)}~\PY{n}{x}\PY{o}{.}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~\PY{k+kn}{Proof}\PY{o}{.}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~~~\PY{n+nb}{induct}~\PY{n}{w}\PY{o}{.}
    \end{input}
    \sep
    \begin{output}
      \begin{goals}
        \begin{goal}
          \begin{hyps}
            \hyp{Q, Σ}{\PY{k+kt}{Type}}
            \sep
            \hyp{M}{\PY{n}{dfa}~\PY{n}{Q}~\PY{n}{Σ}}
            \sep
            \hyp{a}{\PY{n}{Σ}}
            \sep
            \hyp{w}{\PY{n}{list}~\PY{n}{Σ}}
            \sep
            \hyp{IHw}{\PY{k+kr}{forall}~\PY{o}{(}\PY{n+nv}{p}~\PY{o}{:}~\PY{n}{Q}\PY{o}{)}~\PY{o}{(}\PY{n+nv}{x}~\PY{o}{:}~\PY{n}{Σ}\PY{o}{),}~\PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{n}{p}~\PY{o}{(}\PY{n}{w}~\PY{o}{++}~\PY{o}{[}\PY{n}{x}\PY{o}{])}~\PY{o}{=}~\PY{n}{δ}~\PY{n}{M}~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{n}{p}~\PY{n}{w}\PY{o}{)}~\PY{n}{x}}
            \sep
            \hyp{p}{\PY{n}{Q}}
            \sep
            \hyp{x}{\PY{n}{Σ}}
          \end{hyps}
          \sep
          \infrule{}
          \sep
          \begin{conclusion}
            \PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{o}{(}\PY{n}{δ}~\PY{n}{M}~\PY{n}{p}~\PY{n}{a}\PY{o}{)}~\PY{o}{(}\PY{n}{w}~\PY{o}{++}~\PY{o}{[}\PY{n}{x}\PY{o}{])}~\PY{o}{=}\nl
            \PY{n}{δ}~\PY{n}{M}~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{o}{(}\PY{n}{δ}~\PY{n}{M}~\PY{n}{p}~\PY{n}{a}\PY{o}{)}~\PY{n}{w}\PY{o}{)}~\PY{n}{x}
          \end{conclusion}
        \end{goal}
      \end{goals}
    \end{output}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~~~\PY{o}{\PYZhy{}}~
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      \PY{n+nb}{rewrite}~\PY{n}{IHw}\PY{o}{.}
    \end{input}
    \sep
    \begin{output}
      \begin{goals}
        \begin{goal}
          \begin{hyps}
            \hyp{Q, Σ}{\PY{k+kt}{Type}}
            \sep
            \hyp{M}{\PY{n}{dfa}~\PY{n}{Q}~\PY{n}{Σ}}
            \sep
            \hyp{a}{\PY{n}{Σ}}
            \sep
            \hyp{w}{\PY{n}{list}~\PY{n}{Σ}}
            \sep
            \hyp{IHw}{\PY{k+kr}{forall}~\PY{o}{(}\PY{n+nv}{p}~\PY{o}{:}~\PY{n}{Q}\PY{o}{)}~\PY{o}{(}\PY{n+nv}{x}~\PY{o}{:}~\PY{n}{Σ}\PY{o}{),}~\PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{n}{p}~\PY{o}{(}\PY{n}{w}~\PY{o}{++}~\PY{o}{[}\PY{n}{x}\PY{o}{])}~\PY{o}{=}~\PY{n}{δ}~\PY{n}{M}~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{n}{p}~\PY{n}{w}\PY{o}{)}~\PY{n}{x}}
            \sep
            \hyp{p}{\PY{n}{Q}}
            \sep
            \hyp{x}{\PY{n}{Σ}}
          \end{hyps}
          \sep
          \infrule{}
          \sep
          \begin{conclusion}
            \PY{n}{δ}~\PY{n}{M}~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{o}{(}\PY{n}{δ}~\PY{n}{M}~\PY{n}{p}~\PY{n}{a}\PY{o}{)}~\PY{n}{w}\PY{o}{)}~\PY{n}{x}~\PY{o}{=}\nl
            \PY{n}{δ}~\PY{n}{M}~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{o}{(}\PY{n}{δ}~\PY{n}{M}~\PY{n}{p}~\PY{n}{a}\PY{o}{)}~\PY{n}{w}\PY{o}{)}~\PY{n}{x}
          \end{conclusion}
        \end{goal}
      \end{goals}
    \end{output}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      \PY{n+nb+bp}{reflexivity}\PY{o}{.}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~\PY{k+kn}{Qed}\PY{o}{.}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{txt}
    \nl
  \end{txt}
  \sep
  \begin{sentence}
    \begin{input}
      \PY{k+kn}{End}~\PY{n+nf}{DeltaStar}\PY{o}{.}
    \end{input}
  \end{sentence}
\end{alectryon}


\section{Acceptance for DFAs%
  \label{acceptance-for-dfas}%
}

Acceptance of a word $w$ by a dfa $M$ is as simple as checking if 
$\delta^*(s, w) \in F$.

\begin{alectryon}
  % Generator: Alectryon
  \sep
  \begin{sentence}
    \begin{input}
      \PY{k+kn}{Definition}~\PY{n+nf}{acceptb}~\PY{o}{\PYZob{}}\PY{n+nv}{Q}~\PY{n+nv}{Σ}\PY{o}{\PYZcb{}}~\PY{o}{(}\PY{n+nv}{M}~\PY{o}{:}~\PY{n}{dfa}~\PY{n}{Q}~\PY{n}{Σ}\PY{o}{)}~\PY{n+nv}{word}~\PY{o}{:}~\PY{n}{bool}~\PY{o}{:=}\nl
      ~~\PY{n}{M}\PY{o}{.(}\PY{n}{F}\PY{o}{)}~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{n}{M}\PY{o}{.(}\PY{n}{s}\PY{o}{)}~\PY{n}{word}\PY{o}{).}
    \end{input}
  \end{sentence}
\end{alectryon}


\section{Complement of a DFA%
  \label{complement-of-a-dfa}%
}

The complement construction of a DFA is very simpl. You only need to turn final 
states into non-final states and vice-versa. This is achieved in Coq by 
performing the boolean negation of \texttt{\DUrole{code}{\DUrole{highlight}{\DUrole{coq}{\DUrole{n}{M}\DUrole{o}{.(}\DUrole{n}{F}\DUrole{o}{)}}}}}

\begin{alectryon}
  % Generator: Alectryon
  \sep
  \begin{sentence}
    \begin{input}
      \PY{k+kn}{Section}~\PY{n+nf}{Complement}\PY{o}{.}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{txt}
    \nl
  \end{txt}
  \sep
  \begin{sentence}
    \begin{input}
      ~~\PY{k+kn}{Definition}~\PY{n+nf}{compl\PYZus{}dfa}~\PY{o}{\PYZob{}}\PY{n+nv}{Q}~\PY{n+nv}{Σ}\PY{o}{\PYZcb{}}~\PY{o}{(}\PY{n+nv}{M}\PY{o}{:}~\PY{n}{dfa}~\PY{n}{Q}~\PY{n}{Σ}\PY{o}{):}~\PY{n}{dfa}~\PY{n}{Q}~\PY{n}{Σ}~\PY{o}{:=}~\PY{o}{\PYZob{}|}\nl
      ~~~~\PY{n}{states}~\PY{o}{:=}~\PY{n}{M}\PY{o}{.(}\PY{n}{states}\PY{o}{);}\nl
      ~~~~\PY{n}{char}~\PY{o}{:=}~\PY{n}{M}\PY{o}{.(}\PY{n}{char}\PY{o}{);}\nl
      ~~~~\PY{n}{s}~\PY{o}{:=}~\PY{n}{M}\PY{o}{.(}\PY{n}{s}\PY{o}{);}\nl
      ~~~~\PY{n}{F}~\PY{o}{:=}~\PY{k+kr}{fun}~\PY{n+nv}{x}~\PY{o}{=\PYZgt{}}~\PY{n}{negb}~\PY{o}{(}\PY{n}{M}\PY{o}{.(}\PY{n}{F}\PY{o}{)}~\PY{n}{x}\PY{o}{);}\nl
      ~~~~\PY{n}{δ}~\PY{o}{:=}~\PY{n}{M}\PY{o}{.(}\PY{n}{δ}\PY{o}{);}\nl
      ~~\PY{o}{|\PYZcb{}.}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{txt}
    \nl
  \end{txt}
  \sep
  \begin{sentence}
    \begin{input}
      ~~\PY{k+kn}{Variables}~\PY{n+nv}{Q}~\PY{n+nv}{Σ}~\PY{o}{:}~\PY{k+kt}{Type}\PY{o}{.}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~\PY{k+kn}{Variable}~\PY{n+nv}{M}~\PY{o}{:}~\PY{n}{dfa}~\PY{n}{Q}~\PY{n}{Σ}\PY{o}{.}
    \end{input}
  \end{sentence}
\end{alectryon}

The lemma that follows is a \textbf{mirorring} lemma. It shows how both the original 
DFA and the complement DFA \emph{move} together or \emph{mirror} each other i.e. for the 
same input string, the complement DFA \textbf{must} land on the same state as the 
original DFA, provided we start from the same state.

\begin{alectryon}
  % Generator: Alectryon
  \sep
  \begin{sentence}
    \begin{input}
      ~~\PY{k+kn}{Lemma}~\PY{n+nf}{compl\PYZus{}dfa\PYZus{}step}\PY{o}{:}~\PY{k+kr}{forall}~\PY{n+nv}{p}~\PY{n+nv}{w}\PY{o}{,}\nl
      ~~~~\PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{n}{p}~\PY{n}{w}~\PY{o}{=}~\PY{n}{delta\PYZus{}star}~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}~\PY{n}{M}\PY{o}{)}~\PY{n}{p}~\PY{n}{w}\PY{o}{.}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~\PY{k+kn}{Proof}\PY{o}{.}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~~~\PY{n+nb}{intros}\PY{o}{.}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~~~\PY{n+nb}{induct\PYZsq{}}~\PY{n}{w}~\PY{n}{rev\PYZus{}ind}\PY{o}{.}
    \end{input}
    \sep
    \begin{output}
      \begin{goals}
        \begin{goal}
          \begin{hyps}
            \hyp{Q, Σ}{\PY{k+kt}{Type}}
            \sep
            \hyp{M}{\PY{n}{dfa}~\PY{n}{Q}~\PY{n}{Σ}}
            \sep
            \hyp{p}{\PY{n}{Q}}
            \sep
            \hyp{x}{\PY{n}{Σ}}
            \sep
            \hyp{w}{\PY{n}{list}~\PY{n}{Σ}}
            \sep
            \hyp{IHw}{\PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{n}{p}~\PY{n}{w}~\PY{o}{=}~\PY{n}{delta\PYZus{}star}~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}~\PY{n}{M}\PY{o}{)}~\PY{n}{p}~\PY{n}{w}}
          \end{hyps}
          \sep
          \infrule{}
          \sep
          \begin{conclusion}
            \PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{n}{p}~\PY{o}{(}\PY{n}{w}~\PY{o}{++}~\PY{o}{[}\PY{n}{x}\PY{o}{])}~\PY{o}{=}\nl
            \PY{n}{delta\PYZus{}star}~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}~\PY{n}{M}\PY{o}{)}~\PY{n}{p}~\PY{o}{(}\PY{n}{w}~\PY{o}{++}~\PY{o}{[}\PY{n}{x}\PY{o}{])}
          \end{conclusion}
        \end{goal}
      \end{goals}
    \end{output}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~~~\PY{o}{\PYZhy{}}~
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      \PY{n+nb}{simpl}~\PY{k+kr}{in}~\PY{o}{*.}
    \end{input}
    \sep
    \begin{output}
      \begin{goals}
        \begin{goal}
          \begin{hyps}
            \hyp{Q, Σ}{\PY{k+kt}{Type}}
            \sep
            \hyp{M}{\PY{n}{dfa}~\PY{n}{Q}~\PY{n}{Σ}}
            \sep
            \hyp{p}{\PY{n}{Q}}
            \sep
            \hyp{x}{\PY{n}{Σ}}
            \sep
            \hyp{w}{\PY{n}{list}~\PY{n}{Σ}}
            \sep
            \hyp{IHw}{\PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{n}{p}~\PY{n}{w}~\PY{o}{=}~\PY{n}{delta\PYZus{}star}~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}~\PY{n}{M}\PY{o}{)}~\PY{n}{p}~\PY{n}{w}}
          \end{hyps}
          \sep
          \infrule{}
          \sep
          \begin{conclusion}
            \PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{n}{p}~\PY{o}{(}\PY{n}{w}~\PY{o}{++}~\PY{o}{[}\PY{n}{x}\PY{o}{])}~\PY{o}{=}\nl
            \PY{n}{delta\PYZus{}star}~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}~\PY{n}{M}\PY{o}{)}~\PY{n}{p}~\PY{o}{(}\PY{n}{w}~\PY{o}{++}~\PY{o}{[}\PY{n}{x}\PY{o}{])}
          \end{conclusion}
        \end{goal}
      \end{goals}
    \end{output}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~~~~~\PY{n+nb}{rewrite}~\PY{n}{delta\PYZus{}step}\PY{o}{.}
    \end{input}
    \sep
    \begin{output}
      \begin{goals}
        \begin{goal}
          \begin{hyps}
            \hyp{Q, Σ}{\PY{k+kt}{Type}}
            \sep
            \hyp{M}{\PY{n}{dfa}~\PY{n}{Q}~\PY{n}{Σ}}
            \sep
            \hyp{p}{\PY{n}{Q}}
            \sep
            \hyp{x}{\PY{n}{Σ}}
            \sep
            \hyp{w}{\PY{n}{list}~\PY{n}{Σ}}
            \sep
            \hyp{IHw}{\PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{n}{p}~\PY{n}{w}~\PY{o}{=}~\PY{n}{delta\PYZus{}star}~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}~\PY{n}{M}\PY{o}{)}~\PY{n}{p}~\PY{n}{w}}
          \end{hyps}
          \sep
          \infrule{}
          \sep
          \begin{conclusion}
            \PY{n}{δ}~\PY{n}{M}~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{n}{p}~\PY{n}{w}\PY{o}{)}~\PY{n}{x}~\PY{o}{=}\nl
            \PY{n}{delta\PYZus{}star}~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}~\PY{n}{M}\PY{o}{)}~\PY{n}{p}~\PY{o}{(}\PY{n}{w}~\PY{o}{++}~\PY{o}{[}\PY{n}{x}\PY{o}{])}
          \end{conclusion}
        \end{goal}
      \end{goals}
    \end{output}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~~~~~\PY{n+nb}{rewrite}~\PY{n}{delta\PYZus{}step}\PY{o}{.}
    \end{input}
    \sep
    \begin{output}
      \begin{goals}
        \begin{goal}
          \begin{hyps}
            \hyp{Q, Σ}{\PY{k+kt}{Type}}
            \sep
            \hyp{M}{\PY{n}{dfa}~\PY{n}{Q}~\PY{n}{Σ}}
            \sep
            \hyp{p}{\PY{n}{Q}}
            \sep
            \hyp{x}{\PY{n}{Σ}}
            \sep
            \hyp{w}{\PY{n}{list}~\PY{n}{Σ}}
            \sep
            \hyp{IHw}{\PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{n}{p}~\PY{n}{w}~\PY{o}{=}~\PY{n}{delta\PYZus{}star}~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}~\PY{n}{M}\PY{o}{)}~\PY{n}{p}~\PY{n}{w}}
          \end{hyps}
          \sep
          \infrule{}
          \sep
          \begin{conclusion}
            \PY{n}{δ}~\PY{n}{M}~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{n}{p}~\PY{n}{w}\PY{o}{)}~\PY{n}{x}~\PY{o}{=}\nl
            \PY{n}{δ}~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}~\PY{n}{M}\PY{o}{)}~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}~\PY{n}{M}\PY{o}{)}~\PY{n}{p}~\PY{n}{w}\PY{o}{)}~\PY{n}{x}
          \end{conclusion}
        \end{goal}
      \end{goals}
    \end{output}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~~~~~\PY{n+nb}{rewrite}~\PY{n}{IHw}\PY{o}{.}
    \end{input}
    \sep
    \begin{output}
      \begin{goals}
        \begin{goal}
          \begin{hyps}
            \hyp{Q, Σ}{\PY{k+kt}{Type}}
            \sep
            \hyp{M}{\PY{n}{dfa}~\PY{n}{Q}~\PY{n}{Σ}}
            \sep
            \hyp{p}{\PY{n}{Q}}
            \sep
            \hyp{x}{\PY{n}{Σ}}
            \sep
            \hyp{w}{\PY{n}{list}~\PY{n}{Σ}}
            \sep
            \hyp{IHw}{\PY{n}{delta\PYZus{}star}~\PY{n}{M}~\PY{n}{p}~\PY{n}{w}~\PY{o}{=}~\PY{n}{delta\PYZus{}star}~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}~\PY{n}{M}\PY{o}{)}~\PY{n}{p}~\PY{n}{w}}
          \end{hyps}
          \sep
          \infrule{}
          \sep
          \begin{conclusion}
            \PY{n}{δ}~\PY{n}{M}~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}~\PY{n}{M}\PY{o}{)}~\PY{n}{p}~\PY{n}{w}\PY{o}{)}~\PY{n}{x}~\PY{o}{=}\nl
            \PY{n}{δ}~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}~\PY{n}{M}\PY{o}{)}~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}~\PY{n}{M}\PY{o}{)}~\PY{n}{p}~\PY{n}{w}\PY{o}{)}~\PY{n}{x}
          \end{conclusion}
        \end{goal}
      \end{goals}
    \end{output}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~~~~~\PY{n+nb+bp}{reflexivity}\PY{o}{.}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~\PY{k+kn}{Qed}\PY{o}{.}
    \end{input}
  \end{sentence}
\end{alectryon}

We can then use this lemma to prove that our complement DFA constructions is 
actually correct i.e. 
$w \in L(M) \longleftrightarrow w \notin L(\overline M)$.

\begin{alectryon}
  % Generator: Alectryon
  \sep
  \begin{sentence}
    \begin{input}
      ~~\PY{k+kn}{Theorem}~\PY{n+nf}{compl\PYZus{}dfa\PYZus{}correct}\PY{o}{:}~\PY{k+kr}{forall}~\PY{n+nv}{w}\PY{o}{,}\nl
      ~~~~\PY{n}{acceptb}~\PY{n}{M}~\PY{n}{w}~\PY{o}{=}~\PY{n}{true}~\PY{o}{\PYZlt{}\PYZhy{}\PYZgt{}}~\PY{n}{acceptb}~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}~\PY{n}{M}\PY{o}{)}~\PY{n}{w}~\PY{o}{=}~\PY{n}{false}\PY{o}{.}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~\PY{k+kn}{Proof}\PY{o}{.}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~~~\PY{n+nb}{intros}\PY{o}{.}
    \end{input}
    \sep
    \begin{output}
      \begin{goals}
        \begin{goal}
          \begin{hyps}
            \hyp{Q, Σ}{\PY{k+kt}{Type}}
            \sep
            \hyp{M}{\PY{n}{dfa}~\PY{n}{Q}~\PY{n}{Σ}}
            \sep
            \hyp{w}{\PY{n}{list}~\PY{n}{Σ}}
          \end{hyps}
          \sep
          \infrule{}
          \sep
          \begin{conclusion}
            \PY{n}{acceptb}~\PY{n}{M}~\PY{n}{w}~\PY{o}{=}~\PY{n}{true}~\PY{o}{\PYZlt{}\PYZhy{}\PYZgt{}}~\PY{n}{acceptb}~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}~\PY{n}{M}\PY{o}{)}~\PY{n}{w}~\PY{o}{=}~\PY{n}{false}
          \end{conclusion}
        \end{goal}
      \end{goals}
    \end{output}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~~~\PY{n+nb}{unfold}~\PY{n}{acceptb}\PY{o}{.}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~~~\PY{n+nb}{split}\PY{o}{.}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~~~\PY{k+kp}{all}\PY{o}{:}~\PY{n+nb}{rewrite}~\PY{n}{compl\PYZus{}dfa\PYZus{}step}\PY{o}{;}\nl
      ~~~~~~~~~\PY{n+nb}{simpl}\PY{o}{;}\nl
      ~~~~~~~~~\PY{n+nb}{apply}~\PY{n}{Bool}\PY{o}{.}\PY{n}{negb\PYZus{}false\PYZus{}iff}\PY{o}{.}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~\PY{k+kn}{Qed}\PY{o}{.}
    \end{input}
  \end{sentence}
\end{alectryon}

\begin{alectryon}
  % Generator: Alectryon
  \sep
  \begin{sentence}
    \begin{input}
      \PY{k+kn}{End}~\PY{n+nf}{Complement}\PY{o}{.}
    \end{input}
  \end{sentence}
\end{alectryon}


\section{Product Construction: Intersection and Union%
  \label{product-construction-intersection-and-union}%
}

The intersection of two DFAs is now defined. Given DFAs $M_1$ and 
$M_2$ with the same $\Sigma$ we can define the intersection DFA 
$M_\cap$ as:

\begin{itemize}
\item $Q_\cap = Q_1 \times Q_2$

\item $s_\cap = (s_1, s_2)$

\item $F_\cap = F_1 \cap F_2$ i.e. $(q_1, q_2) \in F_\cap \longleftrightarrow q_1 \in F_1 \wedge q_2 \in F_2$

\item $\delta_\cap(q_1, q_2) = (\delta_1(q_1), \delta_2(q_2))$
\end{itemize}

\begin{alectryon}
  % Generator: Alectryon
  \sep
  \begin{sentence}
    \begin{input}
      \PY{k+kn}{Section}~\PY{n+nf}{Product}\PY{o}{.}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{txt}
    \nl
  \end{txt}
  \sep
  \begin{sentence}
    \begin{input}
      \PY{k+kn}{Definition}~\PY{n+nf}{inters\PYZus{}dfa}~\PY{o}{\PYZob{}}\PY{n+nv}{Q\PYZus{}1}~\PY{n+nv}{Q\PYZus{}2}~\PY{n+nv}{Σ}\PY{o}{\PYZcb{}}~\PY{o}{(}\PY{n+nv}{M\PYZus{}1}\PY{o}{:}~\PY{n}{dfa}~\PY{n}{Q\PYZus{}1}~\PY{n}{Σ}\PY{o}{)}~\PY{o}{(}\PY{n+nv}{M\PYZus{}2}\PY{o}{:}~\PY{n}{dfa}~\PY{n}{Q\PYZus{}2}~\PY{n}{Σ}\PY{o}{)}~\PY{o}{:}\nl
      \PY{n}{dfa}~\PY{o}{(}\PY{n}{Q\PYZus{}1}~\PY{o}{*}~\PY{n}{Q\PYZus{}2}\PY{o}{)}~\PY{n}{Σ}~\PY{o}{:=}~\PY{o}{\PYZob{}|}\nl
      ~~\PY{n}{states}~\PY{o}{:=}~\PY{n}{cross\PYZus{}product}~\PY{o}{(}\PY{n}{states}~\PY{n}{M\PYZus{}1}\PY{o}{)}~\PY{o}{(}\PY{n}{states}~\PY{n}{M\PYZus{}2}\PY{o}{);}\nl
      ~~\PY{n}{char}~\PY{o}{:=}~\PY{o}{(}\PY{n}{char}~\PY{n}{M\PYZus{}1}\PY{o}{);}\nl
      ~~\PY{n}{s}~\PY{o}{:=}~\PY{o}{(}\PY{n}{s}~\PY{n}{M\PYZus{}1}\PY{o}{,}~\PY{n}{s}~\PY{n}{M\PYZus{}2}\PY{o}{);}\nl
      ~~\PY{n}{F}~\PY{o}{:=}~\PY{k+kr}{fun}~\PY{n+nv}{p}~\PY{o}{=\PYZgt{}}~\PY{k+kr}{match}~\PY{n}{p}~\PY{k+kr}{with}~\PY{o}{(}\PY{n}{a}\PY{o}{,}~\PY{n}{c}\PY{o}{)}~\PY{o}{=\PYZgt{}}~\PY{o}{(}\PY{n}{F}~\PY{n}{M\PYZus{}1}~\PY{n}{a}\PY{o}{)}~\PY{o}{\PYZam{}\PYZam{}}~\PY{o}{(}\PY{n}{F}~\PY{n}{M\PYZus{}2}~\PY{n}{c}\PY{o}{)}~\PY{k+kr}{end}\PY{o}{;}\nl
      ~~\PY{n}{δ}~\PY{o}{:=}~\PY{k+kr}{fun}~\PY{n+nv}{p}~\PY{n+nv}{x}~\PY{o}{=\PYZgt{}}~\PY{k+kr}{match}~\PY{n}{p}~\PY{k+kr}{with}~\PY{o}{(}\PY{n}{a}\PY{o}{,}~\PY{n}{c}\PY{o}{)}~\PY{o}{=\PYZgt{}}~\PY{o}{(}\PY{n}{δ}~\PY{n}{M\PYZus{}1}~\PY{n}{a}~\PY{n}{x}\PY{o}{,}~\PY{n}{δ}~\PY{n}{M\PYZus{}2}~\PY{n}{c}~\PY{n}{x}\PY{o}{)}~\PY{k+kr}{end}\PY{o}{;}\nl
      \PY{o}{|\PYZcb{}.}
    \end{input}
  \end{sentence}
\end{alectryon}

What follows is the mirroring lemma for the intersection DFA...

\begin{alectryon}
  % Generator: Alectryon
  \sep
  \begin{sentence}
    \begin{input}
      \PY{k+kn}{Lemma}~\PY{n+nf}{inters\PYZus{}dfa\PYZus{}step}~\PY{n+nv}{Q\PYZus{}1}~\PY{n+nv}{Q\PYZus{}2}~\PY{n+nv}{Σ}\PY{o}{:}\nl
      ~~\PY{k+kr}{forall}~\PY{o}{(}\PY{n+nv}{M\PYZus{}1}\PY{o}{:}~\PY{n}{dfa}~\PY{n}{Q\PYZus{}1}~\PY{n}{Σ}\PY{o}{)}~\PY{o}{(}\PY{n+nv}{M\PYZus{}2}\PY{o}{:}~\PY{n}{dfa}~\PY{n}{Q\PYZus{}2}~\PY{n}{Σ}\PY{o}{)}~\PY{n+nv}{p}~\PY{n+nv}{q}~\PY{n+nv}{w}\PY{o}{,}\nl
      ~~~~\PY{n}{delta\PYZus{}star}~\PY{o}{(}\PY{n}{inters\PYZus{}dfa}~\PY{n}{M\PYZus{}1}~\PY{n}{M\PYZus{}2}\PY{o}{)}~\PY{o}{(}\PY{n}{p}\PY{o}{,}~\PY{n}{q}\PY{o}{)}~\PY{n}{w}~\nl
      ~~~~~~\PY{o}{=}~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}1}~\PY{n}{p}~\PY{n}{w}\PY{o}{,}~\PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}2}~\PY{n}{q}~\PY{n}{w}\PY{o}{).}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      \PY{k+kn}{Proof}\PY{o}{.}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~\PY{n+nb}{induct\PYZsq{}}~\PY{n}{w}~\PY{n}{rev\PYZus{}ind}\PY{o}{.}
    \end{input}
    \sep
    \begin{output}
      \begin{goals}
        \begin{goal}
          \begin{hyps}
            \hyp{Q\char`\_1, Q\char`\_2, Σ}{\PY{k+kt}{Type}}
            \sep
            \hyp{M\char`\_1}{\PY{n}{dfa}~\PY{n}{Q\PYZus{}1}~\PY{n}{Σ}}
            \sep
            \hyp{M\char`\_2}{\PY{n}{dfa}~\PY{n}{Q\PYZus{}2}~\PY{n}{Σ}}
            \sep
            \hyp{p}{\PY{n}{Q\PYZus{}1}}
            \sep
            \hyp{q}{\PY{n}{Q\PYZus{}2}}
            \sep
            \hyp{x}{\PY{n}{Σ}}
            \sep
            \hyp{w}{\PY{n}{list}~\PY{n}{Σ}}
            \sep
            \hyp{IHw}{\PY{n}{delta\PYZus{}star}~\PY{o}{(}\PY{n}{inters\PYZus{}dfa}~\PY{n}{M\PYZus{}1}~\PY{n}{M\PYZus{}2}\PY{o}{)}~\PY{o}{(}\PY{n}{p}\PY{o}{,}~\PY{n}{q}\PY{o}{)}~\PY{n}{w}~\PY{o}{=}\nl
            \PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}1}~\PY{n}{p}~\PY{n}{w}\PY{o}{,}~\PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}2}~\PY{n}{q}~\PY{n}{w}\PY{o}{)}}
          \end{hyps}
          \sep
          \infrule{}
          \sep
          \begin{conclusion}
            \PY{n}{delta\PYZus{}star}~\PY{o}{(}\PY{n}{inters\PYZus{}dfa}~\PY{n}{M\PYZus{}1}~\PY{n}{M\PYZus{}2}\PY{o}{)}~\PY{o}{(}\PY{n}{p}\PY{o}{,}~\PY{n}{q}\PY{o}{)}~\PY{o}{(}\PY{n}{w}~\PY{o}{++}~\PY{o}{[}\PY{n}{x}\PY{o}{])}~\PY{o}{=}\nl
            \PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}1}~\PY{n}{p}~\PY{o}{(}\PY{n}{w}~\PY{o}{++}~\PY{o}{[}\PY{n}{x}\PY{o}{]),}\nl
            \PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}2}~\PY{n}{q}~\PY{o}{(}\PY{n}{w}~\PY{o}{++}~\PY{o}{[}\PY{n}{x}\PY{o}{]))}
          \end{conclusion}
        \end{goal}
      \end{goals}
    \end{output}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~\PY{o}{\PYZhy{}}~
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      \PY{n+nb}{rewrite}~\PY{n}{delta\PYZus{}step}\PY{o}{.}
    \end{input}
    \sep
    \begin{output}
      \begin{goals}
        \begin{goal}
          \begin{hyps}
            \hyp{Q\char`\_1, Q\char`\_2, Σ}{\PY{k+kt}{Type}}
            \sep
            \hyp{M\char`\_1}{\PY{n}{dfa}~\PY{n}{Q\PYZus{}1}~\PY{n}{Σ}}
            \sep
            \hyp{M\char`\_2}{\PY{n}{dfa}~\PY{n}{Q\PYZus{}2}~\PY{n}{Σ}}
            \sep
            \hyp{p}{\PY{n}{Q\PYZus{}1}}
            \sep
            \hyp{q}{\PY{n}{Q\PYZus{}2}}
            \sep
            \hyp{x}{\PY{n}{Σ}}
            \sep
            \hyp{w}{\PY{n}{list}~\PY{n}{Σ}}
            \sep
            \hyp{IHw}{\PY{n}{delta\PYZus{}star}~\PY{o}{(}\PY{n}{inters\PYZus{}dfa}~\PY{n}{M\PYZus{}1}~\PY{n}{M\PYZus{}2}\PY{o}{)}~\PY{o}{(}\PY{n}{p}\PY{o}{,}~\PY{n}{q}\PY{o}{)}~\PY{n}{w}~\PY{o}{=}\nl
            \PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}1}~\PY{n}{p}~\PY{n}{w}\PY{o}{,}~\PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}2}~\PY{n}{q}~\PY{n}{w}\PY{o}{)}}
          \end{hyps}
          \sep
          \infrule{}
          \sep
          \begin{conclusion}
            \PY{n}{δ}~\PY{o}{(}\PY{n}{inters\PYZus{}dfa}~\PY{n}{M\PYZus{}1}~\PY{n}{M\PYZus{}2}\PY{o}{)}\nl
            ~~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{o}{(}\PY{n}{inters\PYZus{}dfa}~\PY{n}{M\PYZus{}1}~\PY{n}{M\PYZus{}2}\PY{o}{)}~\PY{o}{(}\PY{n}{p}\PY{o}{,}~\PY{n}{q}\PY{o}{)}~\PY{n}{w}\PY{o}{)}~\PY{n}{x}~\PY{o}{=}\nl
            \PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}1}~\PY{n}{p}~\PY{o}{(}\PY{n}{w}~\PY{o}{++}~\PY{o}{[}\PY{n}{x}\PY{o}{]),}\nl
            \PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}2}~\PY{n}{q}~\PY{o}{(}\PY{n}{w}~\PY{o}{++}~\PY{o}{[}\PY{n}{x}\PY{o}{]))}
          \end{conclusion}
        \end{goal}
      \end{goals}
    \end{output}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~~~\PY{n+nb}{rewrite}~\PY{n}{IHw}\PY{o}{.}
    \end{input}
    \sep
    \begin{output}
      \begin{goals}
        \begin{goal}
          \begin{hyps}
            \hyp{Q\char`\_1, Q\char`\_2, Σ}{\PY{k+kt}{Type}}
            \sep
            \hyp{M\char`\_1}{\PY{n}{dfa}~\PY{n}{Q\PYZus{}1}~\PY{n}{Σ}}
            \sep
            \hyp{M\char`\_2}{\PY{n}{dfa}~\PY{n}{Q\PYZus{}2}~\PY{n}{Σ}}
            \sep
            \hyp{p}{\PY{n}{Q\PYZus{}1}}
            \sep
            \hyp{q}{\PY{n}{Q\PYZus{}2}}
            \sep
            \hyp{x}{\PY{n}{Σ}}
            \sep
            \hyp{w}{\PY{n}{list}~\PY{n}{Σ}}
            \sep
            \hyp{IHw}{\PY{n}{delta\PYZus{}star}~\PY{o}{(}\PY{n}{inters\PYZus{}dfa}~\PY{n}{M\PYZus{}1}~\PY{n}{M\PYZus{}2}\PY{o}{)}~\PY{o}{(}\PY{n}{p}\PY{o}{,}~\PY{n}{q}\PY{o}{)}~\PY{n}{w}~\PY{o}{=}\nl
            \PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}1}~\PY{n}{p}~\PY{n}{w}\PY{o}{,}~\PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}2}~\PY{n}{q}~\PY{n}{w}\PY{o}{)}}
          \end{hyps}
          \sep
          \infrule{}
          \sep
          \begin{conclusion}
            \PY{n}{δ}~\PY{o}{(}\PY{n}{inters\PYZus{}dfa}~\PY{n}{M\PYZus{}1}~\PY{n}{M\PYZus{}2}\PY{o}{)}\nl
            ~~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}1}~\PY{n}{p}~\PY{n}{w}\PY{o}{,}~\PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}2}~\PY{n}{q}~\PY{n}{w}\PY{o}{)}~\PY{n}{x}~\PY{o}{=}\nl
            \PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}1}~\PY{n}{p}~\PY{o}{(}\PY{n}{w}~\PY{o}{++}~\PY{o}{[}\PY{n}{x}\PY{o}{]),}\nl
            \PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}2}~\PY{n}{q}~\PY{o}{(}\PY{n}{w}~\PY{o}{++}~\PY{o}{[}\PY{n}{x}\PY{o}{]))}
          \end{conclusion}
        \end{goal}
      \end{goals}
    \end{output}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~~~\PY{n+nb}{simpl}\PY{o}{.}
    \end{input}
    \sep
    \begin{output}
      \begin{goals}
        \begin{goal}
          \begin{hyps}
            \hyp{Q\char`\_1, Q\char`\_2, Σ}{\PY{k+kt}{Type}}
            \sep
            \hyp{M\char`\_1}{\PY{n}{dfa}~\PY{n}{Q\PYZus{}1}~\PY{n}{Σ}}
            \sep
            \hyp{M\char`\_2}{\PY{n}{dfa}~\PY{n}{Q\PYZus{}2}~\PY{n}{Σ}}
            \sep
            \hyp{p}{\PY{n}{Q\PYZus{}1}}
            \sep
            \hyp{q}{\PY{n}{Q\PYZus{}2}}
            \sep
            \hyp{x}{\PY{n}{Σ}}
            \sep
            \hyp{w}{\PY{n}{list}~\PY{n}{Σ}}
            \sep
            \hyp{IHw}{\PY{n}{delta\PYZus{}star}~\PY{o}{(}\PY{n}{inters\PYZus{}dfa}~\PY{n}{M\PYZus{}1}~\PY{n}{M\PYZus{}2}\PY{o}{)}~\PY{o}{(}\PY{n}{p}\PY{o}{,}~\PY{n}{q}\PY{o}{)}~\PY{n}{w}~\PY{o}{=}\nl
            \PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}1}~\PY{n}{p}~\PY{n}{w}\PY{o}{,}~\PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}2}~\PY{n}{q}~\PY{n}{w}\PY{o}{)}}
          \end{hyps}
          \sep
          \infrule{}
          \sep
          \begin{conclusion}
            \PY{o}{(}\PY{n}{δ}~\PY{n}{M\PYZus{}1}~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}1}~\PY{n}{p}~\PY{n}{w}\PY{o}{)}~\PY{n}{x}\PY{o}{,}\nl
            \PY{n}{δ}~\PY{n}{M\PYZus{}2}~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}2}~\PY{n}{q}~\PY{n}{w}\PY{o}{)}~\PY{n}{x}\PY{o}{)}~\PY{o}{=}\nl
            \PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}1}~\PY{n}{p}~\PY{o}{(}\PY{n}{w}~\PY{o}{++}~\PY{o}{[}\PY{n}{x}\PY{o}{]),}\nl
            \PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}2}~\PY{n}{q}~\PY{o}{(}\PY{n}{w}~\PY{o}{++}~\PY{o}{[}\PY{n}{x}\PY{o}{]))}
          \end{conclusion}
        \end{goal}
      \end{goals}
    \end{output}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~~~\PY{n+nb}{rewrite}~\PY{n}{delta\PYZus{}step}\PY{o}{.}
    \end{input}
    \sep
    \begin{output}
      \begin{goals}
        \begin{goal}
          \begin{hyps}
            \hyp{Q\char`\_1, Q\char`\_2, Σ}{\PY{k+kt}{Type}}
            \sep
            \hyp{M\char`\_1}{\PY{n}{dfa}~\PY{n}{Q\PYZus{}1}~\PY{n}{Σ}}
            \sep
            \hyp{M\char`\_2}{\PY{n}{dfa}~\PY{n}{Q\PYZus{}2}~\PY{n}{Σ}}
            \sep
            \hyp{p}{\PY{n}{Q\PYZus{}1}}
            \sep
            \hyp{q}{\PY{n}{Q\PYZus{}2}}
            \sep
            \hyp{x}{\PY{n}{Σ}}
            \sep
            \hyp{w}{\PY{n}{list}~\PY{n}{Σ}}
            \sep
            \hyp{IHw}{\PY{n}{delta\PYZus{}star}~\PY{o}{(}\PY{n}{inters\PYZus{}dfa}~\PY{n}{M\PYZus{}1}~\PY{n}{M\PYZus{}2}\PY{o}{)}~\PY{o}{(}\PY{n}{p}\PY{o}{,}~\PY{n}{q}\PY{o}{)}~\PY{n}{w}~\PY{o}{=}\nl
            \PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}1}~\PY{n}{p}~\PY{n}{w}\PY{o}{,}~\PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}2}~\PY{n}{q}~\PY{n}{w}\PY{o}{)}}
          \end{hyps}
          \sep
          \infrule{}
          \sep
          \begin{conclusion}
            \PY{o}{(}\PY{n}{δ}~\PY{n}{M\PYZus{}1}~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}1}~\PY{n}{p}~\PY{n}{w}\PY{o}{)}~\PY{n}{x}\PY{o}{,}\nl
            \PY{n}{δ}~\PY{n}{M\PYZus{}2}~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}2}~\PY{n}{q}~\PY{n}{w}\PY{o}{)}~\PY{n}{x}\PY{o}{)}~\PY{o}{=}\nl
            \PY{o}{(}\PY{n}{δ}~\PY{n}{M\PYZus{}1}~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}1}~\PY{n}{p}~\PY{n}{w}\PY{o}{)}~\PY{n}{x}\PY{o}{,}\nl
            \PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}2}~\PY{n}{q}~\PY{o}{(}\PY{n}{w}~\PY{o}{++}~\PY{o}{[}\PY{n}{x}\PY{o}{]))}
          \end{conclusion}
        \end{goal}
      \end{goals}
    \end{output}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~~~\PY{n+nb}{rewrite}~\PY{n}{delta\PYZus{}step}\PY{o}{.}
    \end{input}
    \sep
    \begin{output}
      \begin{goals}
        \begin{goal}
          \begin{hyps}
            \hyp{Q\char`\_1, Q\char`\_2, Σ}{\PY{k+kt}{Type}}
            \sep
            \hyp{M\char`\_1}{\PY{n}{dfa}~\PY{n}{Q\PYZus{}1}~\PY{n}{Σ}}
            \sep
            \hyp{M\char`\_2}{\PY{n}{dfa}~\PY{n}{Q\PYZus{}2}~\PY{n}{Σ}}
            \sep
            \hyp{p}{\PY{n}{Q\PYZus{}1}}
            \sep
            \hyp{q}{\PY{n}{Q\PYZus{}2}}
            \sep
            \hyp{x}{\PY{n}{Σ}}
            \sep
            \hyp{w}{\PY{n}{list}~\PY{n}{Σ}}
            \sep
            \hyp{IHw}{\PY{n}{delta\PYZus{}star}~\PY{o}{(}\PY{n}{inters\PYZus{}dfa}~\PY{n}{M\PYZus{}1}~\PY{n}{M\PYZus{}2}\PY{o}{)}~\PY{o}{(}\PY{n}{p}\PY{o}{,}~\PY{n}{q}\PY{o}{)}~\PY{n}{w}~\PY{o}{=}\nl
            \PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}1}~\PY{n}{p}~\PY{n}{w}\PY{o}{,}~\PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}2}~\PY{n}{q}~\PY{n}{w}\PY{o}{)}}
          \end{hyps}
          \sep
          \infrule{}
          \sep
          \begin{conclusion}
            \PY{o}{(}\PY{n}{δ}~\PY{n}{M\PYZus{}1}~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}1}~\PY{n}{p}~\PY{n}{w}\PY{o}{)}~\PY{n}{x}\PY{o}{,}\nl
            \PY{n}{δ}~\PY{n}{M\PYZus{}2}~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}2}~\PY{n}{q}~\PY{n}{w}\PY{o}{)}~\PY{n}{x}\PY{o}{)}~\PY{o}{=}\nl
            \PY{o}{(}\PY{n}{δ}~\PY{n}{M\PYZus{}1}~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}1}~\PY{n}{p}~\PY{n}{w}\PY{o}{)}~\PY{n}{x}\PY{o}{,}\nl
            \PY{n}{δ}~\PY{n}{M\PYZus{}2}~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}2}~\PY{n}{q}~\PY{n}{w}\PY{o}{)}~\PY{n}{x}\PY{o}{)}
          \end{conclusion}
        \end{goal}
      \end{goals}
    \end{output}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~~~\PY{n+nb+bp}{reflexivity}\PY{o}{.}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      \PY{k+kn}{Qed}\PY{o}{.}
    \end{input}
  \end{sentence}
\end{alectryon}

...and the correctness of the intersection DFA.

\begin{alectryon}
  % Generator: Alectryon
  \sep
  \begin{sentence}
    \begin{input}
      \PY{k+kn}{Theorem}~\PY{n+nf}{inters\PYZus{}dfa\PYZus{}correct}~\PY{n+nv}{Q\PYZus{}1}~\PY{n+nv}{Q\PYZus{}2}~\PY{n+nv}{Σ}\PY{o}{:}~\nl
      ~~\PY{k+kr}{forall}~\PY{o}{(}\PY{n+nv}{M\PYZus{}1}\PY{o}{:}~\PY{n}{dfa}~\PY{n}{Q\PYZus{}1}~\PY{n}{Σ}\PY{o}{)}~\PY{o}{(}\PY{n+nv}{M\PYZus{}2}\PY{o}{:}~\PY{n}{dfa}~\PY{n}{Q\PYZus{}2}~\PY{n}{Σ}\PY{o}{)}~\PY{n+nv}{w}\PY{o}{,}\nl
      ~~\PY{n}{acceptb}~\PY{o}{(}\PY{n}{inters\PYZus{}dfa}~\PY{n}{M\PYZus{}1}~\PY{n}{M\PYZus{}2}\PY{o}{)}~\PY{n}{w}~\PY{o}{=}~\PY{n}{true}\nl
      ~~~~\PY{o}{\PYZlt{}\PYZhy{}\PYZgt{}}~\PY{o}{(}\PY{n}{acceptb}~\PY{n}{M\PYZus{}1}~\PY{n}{w}~\PY{o}{=}~\PY{n}{true}\PY{o}{)}~\PY{o}{/\PYZbs{}}~\PY{o}{(}\PY{n}{acceptb}~\PY{n}{M\PYZus{}2}~\PY{n}{w}~\PY{o}{=}~\PY{n}{true}\PY{o}{).}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      \PY{k+kn}{Proof}\PY{o}{.}
    \end{input}
    \sep
    \begin{output}
      \begin{goals}
        \begin{goal}
          \begin{hyps}
            \hyp{Q\char`\_1, Q\char`\_2, Σ}{\PY{k+kt}{Type}}
          \end{hyps}
          \sep
          \infrule{}
          \sep
          \begin{conclusion}
            \PY{k+kr}{forall}~\PY{o}{(}\PY{n+nv}{M\PYZus{}1}~\PY{o}{:}~\PY{n}{dfa}~\PY{n}{Q\PYZus{}1}~\PY{n}{Σ}\PY{o}{)}~\PY{o}{(}\PY{n+nv}{M\PYZus{}2}~\PY{o}{:}~\PY{n}{dfa}~\PY{n}{Q\PYZus{}2}~\PY{n}{Σ}\PY{o}{)}\nl
            ~~\PY{o}{(}\PY{n+nv}{w}~\PY{o}{:}~\PY{n}{list}~\PY{n}{Σ}\PY{o}{),}\nl
            \PY{n}{acceptb}~\PY{o}{(}\PY{n}{inters\PYZus{}dfa}~\PY{n}{M\PYZus{}1}~\PY{n}{M\PYZus{}2}\PY{o}{)}~\PY{n}{w}~\PY{o}{=}~\PY{n}{true}~\PY{o}{\PYZlt{}\PYZhy{}\PYZgt{}}\nl
            \PY{n}{acceptb}~\PY{n}{M\PYZus{}1}~\PY{n}{w}~\PY{o}{=}~\PY{n}{true}~\PY{o}{/\PYZbs{}}~\PY{n}{acceptb}~\PY{n}{M\PYZus{}2}~\PY{n}{w}~\PY{o}{=}~\PY{n}{true}
          \end{conclusion}
        \end{goal}
      \end{goals}
    \end{output}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~\PY{n+nb}{unfold}~\PY{n}{acceptb}\PY{o}{.}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~\PY{n+nb}{split}\PY{o}{.}
    \end{input}
    \sep
    \begin{output}
      \begin{goals}
        \begin{goal}
          \begin{hyps}
            \hyp{Q\char`\_1, Q\char`\_2, Σ}{\PY{k+kt}{Type}}
            \sep
            \hyp{M\char`\_1}{\PY{n}{dfa}~\PY{n}{Q\PYZus{}1}~\PY{n}{Σ}}
            \sep
            \hyp{M\char`\_2}{\PY{n}{dfa}~\PY{n}{Q\PYZus{}2}~\PY{n}{Σ}}
            \sep
            \hyp{w}{\PY{n}{list}~\PY{n}{Σ}}
          \end{hyps}
          \sep
          \infrule{}
          \sep
          \begin{conclusion}
            \PY{n}{F}~\PY{o}{(}\PY{n}{inters\PYZus{}dfa}~\PY{n}{M\PYZus{}1}~\PY{n}{M\PYZus{}2}\PY{o}{)}\nl
            ~~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{o}{(}\PY{n}{inters\PYZus{}dfa}~\PY{n}{M\PYZus{}1}~\PY{n}{M\PYZus{}2}\PY{o}{)}\nl
            ~~~~~\PY{o}{(}\PY{n}{s}~\PY{o}{(}\PY{n}{inters\PYZus{}dfa}~\PY{n}{M\PYZus{}1}~\PY{n}{M\PYZus{}2}\PY{o}{))}~\PY{n}{w}\PY{o}{)}~\PY{o}{=}~\PY{n}{true}~\PY{o}{\PYZhy{}\PYZgt{}}\nl
            \PY{n}{F}~\PY{n}{M\PYZus{}1}~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}1}~\PY{o}{(}\PY{n}{s}~\PY{n}{M\PYZus{}1}\PY{o}{)}~\PY{n}{w}\PY{o}{)}~\PY{o}{=}~\PY{n}{true}~\PY{o}{/\PYZbs{}}\nl
            \PY{n}{F}~\PY{n}{M\PYZus{}2}~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}2}~\PY{o}{(}\PY{n}{s}~\PY{n}{M\PYZus{}2}\PY{o}{)}~\PY{n}{w}\PY{o}{)}~\PY{o}{=}~\PY{n}{true}
          \end{conclusion}
        \end{goal}
        \sep
        \begin{extragoals}
          \begin{goal}
            \begin{hyps}
              \hyp{Q\char`\_1, Q\char`\_2, Σ}{\PY{k+kt}{Type}}
              \sep
              \hyp{M\char`\_1}{\PY{n}{dfa}~\PY{n}{Q\PYZus{}1}~\PY{n}{Σ}}
              \sep
              \hyp{M\char`\_2}{\PY{n}{dfa}~\PY{n}{Q\PYZus{}2}~\PY{n}{Σ}}
              \sep
              \hyp{w}{\PY{n}{list}~\PY{n}{Σ}}
            \end{hyps}
            \sep
            \infrule{}
            \sep
            \begin{conclusion}
              \PY{n}{F}~\PY{n}{M\PYZus{}1}~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}1}~\PY{o}{(}\PY{n}{s}~\PY{n}{M\PYZus{}1}\PY{o}{)}~\PY{n}{w}\PY{o}{)}~\PY{o}{=}~\PY{n}{true}~\PY{o}{/\PYZbs{}}\nl
              \PY{n}{F}~\PY{n}{M\PYZus{}2}~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{n}{M\PYZus{}2}~\PY{o}{(}\PY{n}{s}~\PY{n}{M\PYZus{}2}\PY{o}{)}~\PY{n}{w}\PY{o}{)}~\PY{o}{=}~\PY{n}{true}~\PY{o}{\PYZhy{}\PYZgt{}}\nl
              \PY{n}{F}~\PY{o}{(}\PY{n}{inters\PYZus{}dfa}~\PY{n}{M\PYZus{}1}~\PY{n}{M\PYZus{}2}\PY{o}{)}\nl
              ~~\PY{o}{(}\PY{n}{delta\PYZus{}star}~\PY{o}{(}\PY{n}{inters\PYZus{}dfa}~\PY{n}{M\PYZus{}1}~\PY{n}{M\PYZus{}2}\PY{o}{)}\nl
              ~~~~~\PY{o}{(}\PY{n}{s}~\PY{o}{(}\PY{n}{inters\PYZus{}dfa}~\PY{n}{M\PYZus{}1}~\PY{n}{M\PYZus{}2}\PY{o}{))}~\PY{n}{w}\PY{o}{)}~\PY{o}{=}~\PY{n}{true}
            \end{conclusion}
          \end{goal}
        \end{extragoals}
      \end{goals}
    \end{output}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~\PY{k+kp}{all}\PY{o}{:}~\PY{n+nb}{simpl}\PY{o}{;}\nl
      ~~~~~~~\PY{n+nb}{rewrite}~\PY{n}{inters\PYZus{}dfa\PYZus{}step}\PY{o}{;}\nl
      ~~~~~~~\PY{n+nb}{apply}~\PY{n}{Bool}\PY{o}{.}\PY{n}{andb\PYZus{}true\PYZus{}iff}\PY{o}{.}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      \PY{k+kn}{Qed}\PY{o}{.}
    \end{input}
  \end{sentence}
\end{alectryon}

The union DFA is defined very easily using DeMorgan's law:
%
\begin{equation*}
M_\cup = \overline{\overline{M_1} \cap \overline{M_2}}
\end{equation*}
, which we define as such in Coq...

\begin{alectryon}
  % Generator: Alectryon
  \sep
  \begin{sentence}
    \begin{input}
      \PY{k+kn}{Definition}~\PY{n+nf}{union\PYZus{}dfa}~\PY{o}{\PYZob{}}\PY{n+nv}{Q\PYZus{}1}~\PY{n+nv}{Q\PYZus{}2}~\PY{n+nv}{Σ}\PY{o}{\PYZcb{}}~\PY{o}{(}\PY{n+nv}{M\PYZus{}1}\PY{o}{:}~\PY{n}{dfa}~\PY{n}{Q\PYZus{}1}~\PY{n}{Σ}\PY{o}{)}~\PY{o}{(}\PY{n+nv}{M\PYZus{}2}\PY{o}{:}~\PY{n}{dfa}~\PY{n}{Q\PYZus{}2}~\PY{n}{Σ}\PY{o}{)}~\PY{o}{:=}\nl
      ~~\PY{n}{compl\PYZus{}dfa}~\PY{o}{(}\PY{n}{inters\PYZus{}dfa}~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}~\PY{n}{M\PYZus{}1}\PY{o}{)}~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}~\PY{n}{M\PYZus{}2}\PY{o}{)).}
    \end{input}
  \end{sentence}
\end{alectryon}

...and then prove its correctness.

\begin{alectryon}
  % Generator: Alectryon
  \sep
  \begin{sentence}
    \begin{input}
      \PY{k+kn}{Theorem}~\PY{n+nf}{union\PYZus{}dfa\PYZus{}correct}~\PY{n+nv}{Q\PYZus{}1}~\PY{n+nv}{Q\PYZus{}2}~\PY{n+nv}{Σ}\PY{o}{:}\nl
      ~~\PY{k+kr}{forall}~\PY{o}{(}\PY{n+nv}{M\PYZus{}1}\PY{o}{:}~\PY{n}{dfa}~\PY{n}{Q\PYZus{}1}~\PY{n}{Σ}\PY{o}{)}~\PY{o}{(}\PY{n+nv}{M\PYZus{}2}\PY{o}{:}~\PY{n}{dfa}~\PY{n}{Q\PYZus{}2}~\PY{n}{Σ}\PY{o}{)}~\PY{n+nv}{w}\PY{o}{,}\nl
      ~~\PY{n}{acceptb}~\PY{o}{(}\PY{n}{union\PYZus{}dfa}~\PY{n}{M\PYZus{}1}~\PY{n}{M\PYZus{}2}\PY{o}{)}~\PY{n}{w}~\PY{o}{=}~\PY{n}{true}~\nl
      ~~~~\PY{o}{\PYZlt{}\PYZhy{}\PYZgt{}}~\PY{o}{(}\PY{n}{acceptb}~\PY{n}{M\PYZus{}1}~\PY{n}{w}~\PY{o}{=}~\PY{n}{true}\PY{o}{)}~\PY{o}{\PYZbs{}/}~\PY{o}{(}\PY{n}{acceptb}~\PY{n}{M\PYZus{}2}~\PY{n}{w}~\PY{o}{=}~\PY{n}{true}\PY{o}{).}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      \PY{k+kn}{Proof}\PY{o}{.}
    \end{input}
    \sep
    \begin{output}
      \begin{goals}
        \begin{goal}
          \begin{hyps}
            \hyp{Q\char`\_1, Q\char`\_2, Σ}{\PY{k+kt}{Type}}
          \end{hyps}
          \sep
          \infrule{}
          \sep
          \begin{conclusion}
            \PY{k+kr}{forall}~\PY{o}{(}\PY{n+nv}{M\PYZus{}1}~\PY{o}{:}~\PY{n}{dfa}~\PY{n}{Q\PYZus{}1}~\PY{n}{Σ}\PY{o}{)}~\PY{o}{(}\PY{n+nv}{M\PYZus{}2}~\PY{o}{:}~\PY{n}{dfa}~\PY{n}{Q\PYZus{}2}~\PY{n}{Σ}\PY{o}{)}\nl
            ~~\PY{o}{(}\PY{n+nv}{w}~\PY{o}{:}~\PY{n}{list}~\PY{n}{Σ}\PY{o}{),}\nl
            \PY{n}{acceptb}~\PY{o}{(}\PY{n}{union\PYZus{}dfa}~\PY{n}{M\PYZus{}1}~\PY{n}{M\PYZus{}2}\PY{o}{)}~\PY{n}{w}~\PY{o}{=}~\PY{n}{true}~\PY{o}{\PYZlt{}\PYZhy{}\PYZgt{}}\nl
            \PY{n}{acceptb}~\PY{n}{M\PYZus{}1}~\PY{n}{w}~\PY{o}{=}~\PY{n}{true}~\PY{o}{\PYZbs{}/}~\PY{n}{acceptb}~\PY{n}{M\PYZus{}2}~\PY{n}{w}~\PY{o}{=}~\PY{n}{true}
          \end{conclusion}
        \end{goal}
      \end{goals}
    \end{output}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~\PY{n+nb}{split}\PY{o}{;}~\PY{n+nb}{unfold}~\PY{n}{union\PYZus{}dfa}\PY{o}{;}~\PY{n+nb}{intros}\PY{o}{.}
    \end{input}
    \sep
    \begin{output}
      \begin{goals}
        \begin{goal}
          \begin{hyps}
            \hyp{Q\char`\_1, Q\char`\_2, Σ}{\PY{k+kt}{Type}}
            \sep
            \hyp{M\char`\_1}{\PY{n}{dfa}~\PY{n}{Q\PYZus{}1}~\PY{n}{Σ}}
            \sep
            \hyp{M\char`\_2}{\PY{n}{dfa}~\PY{n}{Q\PYZus{}2}~\PY{n}{Σ}}
            \sep
            \hyp{w}{\PY{n}{list}~\PY{n}{Σ}}
            \sep
            \hyp{H}{\PY{n}{acceptb}\nl
            ~~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}\nl
            ~~~~~\PY{o}{(}\PY{n}{inters\PYZus{}dfa}~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}~\PY{n}{M\PYZus{}1}\PY{o}{)}~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}~\PY{n}{M\PYZus{}2}\PY{o}{)))}\nl
            ~~\PY{n}{w}~\PY{o}{=}~\PY{n}{true}}
          \end{hyps}
          \sep
          \infrule{}
          \sep
          \begin{conclusion}
            \PY{n}{acceptb}~\PY{n}{M\PYZus{}1}~\PY{n}{w}~\PY{o}{=}~\PY{n}{true}~\PY{o}{\PYZbs{}/}~\PY{n}{acceptb}~\PY{n}{M\PYZus{}2}~\PY{n}{w}~\PY{o}{=}~\PY{n}{true}
          \end{conclusion}
        \end{goal}
        \sep
        \begin{extragoals}
          \begin{goal}
            \begin{hyps}
              \hyp{Q\char`\_1, Q\char`\_2, Σ}{\PY{k+kt}{Type}}
              \sep
              \hyp{M\char`\_1}{\PY{n}{dfa}~\PY{n}{Q\PYZus{}1}~\PY{n}{Σ}}
              \sep
              \hyp{M\char`\_2}{\PY{n}{dfa}~\PY{n}{Q\PYZus{}2}~\PY{n}{Σ}}
              \sep
              \hyp{w}{\PY{n}{list}~\PY{n}{Σ}}
              \sep
              \hyp{H}{\PY{n}{acceptb}~\PY{n}{M\PYZus{}1}~\PY{n}{w}~\PY{o}{=}~\PY{n}{true}~\PY{o}{\PYZbs{}/}~\PY{n}{acceptb}~\PY{n}{M\PYZus{}2}~\PY{n}{w}~\PY{o}{=}~\PY{n}{true}}
            \end{hyps}
            \sep
            \infrule{}
            \sep
            \begin{conclusion}
              \PY{n}{acceptb}\nl
              ~~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}\nl
              ~~~~~\PY{o}{(}\PY{n}{inters\PYZus{}dfa}~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}~\PY{n}{M\PYZus{}1}\PY{o}{)}~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}~\PY{n}{M\PYZus{}2}\PY{o}{)))}~\PY{n}{w}~\PY{o}{=}\nl
              \PY{n}{true}
            \end{conclusion}
          \end{goal}
        \end{extragoals}
      \end{goals}
    \end{output}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~\PY{o}{\PYZhy{}}
    \end{input}
    \sep
    \begin{output}
      \begin{goals}
        \begin{goal}
          \begin{hyps}
            \hyp{Q\char`\_1, Q\char`\_2, Σ}{\PY{k+kt}{Type}}
            \sep
            \hyp{M\char`\_1}{\PY{n}{dfa}~\PY{n}{Q\PYZus{}1}~\PY{n}{Σ}}
            \sep
            \hyp{M\char`\_2}{\PY{n}{dfa}~\PY{n}{Q\PYZus{}2}~\PY{n}{Σ}}
            \sep
            \hyp{w}{\PY{n}{list}~\PY{n}{Σ}}
            \sep
            \hyp{H}{\PY{n}{acceptb}\nl
            ~~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}\nl
            ~~~~~\PY{o}{(}\PY{n}{inters\PYZus{}dfa}~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}~\PY{n}{M\PYZus{}1}\PY{o}{)}~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}~\PY{n}{M\PYZus{}2}\PY{o}{)))}\nl
            ~~\PY{n}{w}~\PY{o}{=}~\PY{n}{true}}
          \end{hyps}
          \sep
          \infrule{}
          \sep
          \begin{conclusion}
            \PY{n}{acceptb}~\PY{n}{M\PYZus{}1}~\PY{n}{w}~\PY{o}{=}~\PY{n}{true}~\PY{o}{\PYZbs{}/}~\PY{n}{acceptb}~\PY{n}{M\PYZus{}2}~\PY{n}{w}~\PY{o}{=}~\PY{n}{true}
          \end{conclusion}
        \end{goal}
      \end{goals}
    \end{output}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      \PY{n+nb}{apply}~\PY{n}{compl\PYZus{}dfa\PYZus{}correct\PYZus{}corr}~\PY{k+kr}{in}~\PY{n}{H}\PY{o}{.}
    \end{input}
    \sep
    \begin{output}
      \begin{goals}
        \begin{goal}
          \begin{hyps}
            \hyp{Q\char`\_1, Q\char`\_2, Σ}{\PY{k+kt}{Type}}
            \sep
            \hyp{M\char`\_1}{\PY{n}{dfa}~\PY{n}{Q\PYZus{}1}~\PY{n}{Σ}}
            \sep
            \hyp{M\char`\_2}{\PY{n}{dfa}~\PY{n}{Q\PYZus{}2}~\PY{n}{Σ}}
            \sep
            \hyp{w}{\PY{n}{list}~\PY{n}{Σ}}
            \sep
            \hyp{H}{\PY{n}{acceptb}\nl
            ~~\PY{o}{(}\PY{n}{inters\PYZus{}dfa}~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}~\PY{n}{M\PYZus{}1}\PY{o}{)}~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}~\PY{n}{M\PYZus{}2}\PY{o}{))}~\PY{n}{w}~\PY{o}{=}\nl
            \PY{n}{false}}
          \end{hyps}
          \sep
          \infrule{}
          \sep
          \begin{conclusion}
            \PY{n}{acceptb}~\PY{n}{M\PYZus{}1}~\PY{n}{w}~\PY{o}{=}~\PY{n}{true}~\PY{o}{\PYZbs{}/}~\PY{n}{acceptb}~\PY{n}{M\PYZus{}2}~\PY{n}{w}~\PY{o}{=}~\PY{n}{true}
          \end{conclusion}
        \end{goal}
      \end{goals}
    \end{output}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~~~\PY{n+nb}{apply}~\PY{n}{inters\PYZus{}dfa\PYZus{}correct\PYZus{}corr}~\PY{k+kr}{in}~\PY{n}{H}\PY{o}{.}
    \end{input}
    \sep
    \begin{output}
      \begin{goals}
        \begin{goal}
          \begin{hyps}
            \hyp{Q\char`\_1, Q\char`\_2, Σ}{\PY{k+kt}{Type}}
            \sep
            \hyp{M\char`\_1}{\PY{n}{dfa}~\PY{n}{Q\PYZus{}1}~\PY{n}{Σ}}
            \sep
            \hyp{M\char`\_2}{\PY{n}{dfa}~\PY{n}{Q\PYZus{}2}~\PY{n}{Σ}}
            \sep
            \hyp{w}{\PY{n}{list}~\PY{n}{Σ}}
            \sep
            \hyp{H}{\PY{n}{acceptb}~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}~\PY{n}{M\PYZus{}1}\PY{o}{)}~\PY{n}{w}~\PY{o}{=}~\PY{n}{false}~\PY{o}{\PYZbs{}/}\nl
            \PY{n}{acceptb}~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}~\PY{n}{M\PYZus{}2}\PY{o}{)}~\PY{n}{w}~\PY{o}{=}~\PY{n}{false}}
          \end{hyps}
          \sep
          \infrule{}
          \sep
          \begin{conclusion}
            \PY{n}{acceptb}~\PY{n}{M\PYZus{}1}~\PY{n}{w}~\PY{o}{=}~\PY{n}{true}~\PY{o}{\PYZbs{}/}~\PY{n}{acceptb}~\PY{n}{M\PYZus{}2}~\PY{n}{w}~\PY{o}{=}~\PY{n}{true}
          \end{conclusion}
        \end{goal}
      \end{goals}
    \end{output}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~~~\PY{n+nb}{destruct}~\PY{n}{H}~\PY{k+kr}{as}~\PY{o}{[}\PY{n}{H}~\PY{o}{|}~\PY{n}{H}\PY{o}{];}\nl
      ~~~~\PY{n+nb}{apply}~\PY{n}{compl\PYZus{}dfa\PYZus{}correct}~\PY{k+kr}{in}~\PY{n}{H}\PY{o}{;}\nl
      ~~~~\PY{o}{[}\PY{n+nb}{left}~\PY{o}{|}~\PY{n+nb}{right}\PY{o}{];}\nl
      ~~~~\PY{n+nb+bp}{assumption}\PY{o}{.}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~\PY{o}{\PYZhy{}}
    \end{input}
    \sep
    \begin{output}
      \begin{goals}
        \begin{goal}
          \begin{hyps}
            \hyp{Q\char`\_1, Q\char`\_2, Σ}{\PY{k+kt}{Type}}
            \sep
            \hyp{M\char`\_1}{\PY{n}{dfa}~\PY{n}{Q\PYZus{}1}~\PY{n}{Σ}}
            \sep
            \hyp{M\char`\_2}{\PY{n}{dfa}~\PY{n}{Q\PYZus{}2}~\PY{n}{Σ}}
            \sep
            \hyp{w}{\PY{n}{list}~\PY{n}{Σ}}
            \sep
            \hyp{H}{\PY{n}{acceptb}~\PY{n}{M\PYZus{}1}~\PY{n}{w}~\PY{o}{=}~\PY{n}{true}~\PY{o}{\PYZbs{}/}~\PY{n}{acceptb}~\PY{n}{M\PYZus{}2}~\PY{n}{w}~\PY{o}{=}~\PY{n}{true}}
          \end{hyps}
          \sep
          \infrule{}
          \sep
          \begin{conclusion}
            \PY{n}{acceptb}\nl
            ~~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}\nl
            ~~~~~\PY{o}{(}\PY{n}{inters\PYZus{}dfa}~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}~\PY{n}{M\PYZus{}1}\PY{o}{)}~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}~\PY{n}{M\PYZus{}2}\PY{o}{)))}~\PY{n}{w}~\PY{o}{=}\nl
            \PY{n}{true}
          \end{conclusion}
        \end{goal}
      \end{goals}
    \end{output}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      \PY{n+nb}{apply}~\PY{n}{compl\PYZus{}dfa\PYZus{}correct\PYZus{}corr}\PY{o}{.}
    \end{input}
    \sep
    \begin{output}
      \begin{goals}
        \begin{goal}
          \begin{hyps}
            \hyp{Q\char`\_1, Q\char`\_2, Σ}{\PY{k+kt}{Type}}
            \sep
            \hyp{M\char`\_1}{\PY{n}{dfa}~\PY{n}{Q\PYZus{}1}~\PY{n}{Σ}}
            \sep
            \hyp{M\char`\_2}{\PY{n}{dfa}~\PY{n}{Q\PYZus{}2}~\PY{n}{Σ}}
            \sep
            \hyp{w}{\PY{n}{list}~\PY{n}{Σ}}
            \sep
            \hyp{H}{\PY{n}{acceptb}~\PY{n}{M\PYZus{}1}~\PY{n}{w}~\PY{o}{=}~\PY{n}{true}~\PY{o}{\PYZbs{}/}~\PY{n}{acceptb}~\PY{n}{M\PYZus{}2}~\PY{n}{w}~\PY{o}{=}~\PY{n}{true}}
          \end{hyps}
          \sep
          \infrule{}
          \sep
          \begin{conclusion}
            \PY{n}{acceptb}~\PY{o}{(}\PY{n}{inters\PYZus{}dfa}~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}~\PY{n}{M\PYZus{}1}\PY{o}{)}~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}~\PY{n}{M\PYZus{}2}\PY{o}{))}~\PY{n}{w}~\PY{o}{=}\nl
            \PY{n}{false}
          \end{conclusion}
        \end{goal}
      \end{goals}
    \end{output}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~~~\PY{n+nb}{apply}~\PY{n}{inters\PYZus{}dfa\PYZus{}correct\PYZus{}corr}\PY{o}{.}
    \end{input}
    \sep
    \begin{output}
      \begin{goals}
        \begin{goal}
          \begin{hyps}
            \hyp{Q\char`\_1, Q\char`\_2, Σ}{\PY{k+kt}{Type}}
            \sep
            \hyp{M\char`\_1}{\PY{n}{dfa}~\PY{n}{Q\PYZus{}1}~\PY{n}{Σ}}
            \sep
            \hyp{M\char`\_2}{\PY{n}{dfa}~\PY{n}{Q\PYZus{}2}~\PY{n}{Σ}}
            \sep
            \hyp{w}{\PY{n}{list}~\PY{n}{Σ}}
            \sep
            \hyp{H}{\PY{n}{acceptb}~\PY{n}{M\PYZus{}1}~\PY{n}{w}~\PY{o}{=}~\PY{n}{true}~\PY{o}{\PYZbs{}/}~\PY{n}{acceptb}~\PY{n}{M\PYZus{}2}~\PY{n}{w}~\PY{o}{=}~\PY{n}{true}}
          \end{hyps}
          \sep
          \infrule{}
          \sep
          \begin{conclusion}
            \PY{n}{acceptb}~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}~\PY{n}{M\PYZus{}1}\PY{o}{)}~\PY{n}{w}~\PY{o}{=}~\PY{n}{false}~\PY{o}{\PYZbs{}/}\nl
            \PY{n}{acceptb}~\PY{o}{(}\PY{n}{compl\PYZus{}dfa}~\PY{n}{M\PYZus{}2}\PY{o}{)}~\PY{n}{w}~\PY{o}{=}~\PY{n}{false}
          \end{conclusion}
        \end{goal}
      \end{goals}
    \end{output}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      ~~~~\PY{n+nb}{destruct}~\PY{n}{H}~\PY{k+kr}{as}~\PY{o}{[}\PY{n}{H}~\PY{o}{|}~\PY{n}{H}\PY{o}{];}\nl
      ~~~~\PY{n+nb}{apply}~\PY{n}{compl\PYZus{}dfa\PYZus{}correct}~\PY{k+kr}{in}~\PY{n}{H}\PY{o}{;}\nl
      ~~~~\PY{o}{[}\PY{n+nb}{left}~\PY{o}{|}~\PY{n+nb}{right}\PY{o}{];}\nl
      ~~~~\PY{n+nb+bp}{assumption}\PY{o}{.}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{sentence}
    \begin{input}
      \PY{k+kn}{Qed}\PY{o}{.}\nl
    \end{input}
  \end{sentence}
  \sep
  \begin{txt}
    \nl
  \end{txt}
  \sep
  \begin{sentence}
    \begin{input}
      \PY{k+kn}{End}~\PY{n+nf}{Product}\PY{o}{.}
    \end{input}
  \end{sentence}
\end{alectryon}

\end{document}
